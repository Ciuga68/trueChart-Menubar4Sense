= {tcmenu}: Documentation
:author:    HighCoordination GmbH
:email:     info@highcoordination.de
:revnumber: {appversion}
:revdate:   {docdate}
:tcmenu:    trueChart Menubar
:title-logo-image: image:wortbildmarke.png[Logo,400]
// :title-page-background-image: image:background.jpg[]
:tbd:       Yet to be done.
:imagesdir: img
:icons: font
:toc: left
:toclevels: 4
:idprefix:
:sectlinks:
:sectanchors:
:sectnums:
:sectnumlevels: 3


// :numbered!:
// [abstract]
// {tcmenu} is a Qlik Sense extension providing a customziable menu bar to interact with. This guide covers installation of the extension, creation of simple menu bars and settings of {tcmenu}'s items.
<<<
<<<
:numbered:
== Introduction
**{tcmenu}** allows for vertical and horizontal buttons and selections
(fields, drill-down dimensions, master dimensions and variables) as well as unlimited trigger based Actions.

In addition, you can share apps with the current selection with a single click, as well as conveniently chain
documents including current or changed selections to navigate between apps.

.Qlik Sense showing a sheet in edit mode with a {tcmenu} (left) next to trueChart (center) with the menu bar's options in the properties panel (right).

image::tcmenu-intro.png[{tcmenu} intro, 550]

=== Qlik Sense® Support
trueChart-Menubar supports Qlik Sense® from version 3.0.0 up to currently latest version April 2018 including
exporting and story mode capability.

=== nPrinting Support
The trueChart-Menubar does not yet fully support nPrinting. Expression updates are not performed due to technical
restrictions. The general export (without expressions) was successfully tested with the nPrinting 2017 September version.

=== Browser Support
At present trueChart-Menubar supports the browsers listed below:

* Microsoft Internet Explorer 11
* Microsoft Edge (lastest version - v40, at the time of writing)
* Mozilla Firefox (latest version – v59, at the time of writing)
* Google Chrome (latest version – v66, at the time of writing)
* iOS 10.3.2 or later
** We recommend upgrading to iOS 11.2.2 or later.

[#whats_new]
== What is new in {tcmenu} {appversion}?

New element _Date Picker_::
The fully customizable new element <<Date Picker>> allows selecting single dates, multiple dates and date ranges for sense fields.
With the support of dynamic date formats the Date Picker can select almost every possible date.
Standardized and freely customizable date ranges allow a wide variety of date selections with just one click.

image::datepicker-range.png[datepicker-range]

New element _Variable Slider_::
The new element <<Variable Slider>> allows to modify the value of variables in different ways. Three different types are supported: single, range and multi
slider.

image::variableslider-examples.png[variableslider-examples]

New element _Variable Input_::
The new <<Variable Input>> allows you to modify the value of variables with an input field. _Variable Inputs_  blend in with the menu and are only visible when
the input is clicked.

.Variable Inputs in a menu.
image::variableinput-display.png[variableinput-example]

Options to disable sense snapshot and maximize object buttons::
Two new properties in the Sense property panel allow conditional hiding of the snapshot and maximize button.

.Sense navbar buttons.
image::sense-navbarbuttons.png[sense-navbarbuttons]

*For more information about the changes in this version, refer to the chapter <<release_notes_latest_version>>*

[CAUTION]
An upgrade from version less than v1.1.0 to the current version may require an migration. If this migration is not done
carefully, apps may break. The procedure is described in detail in <<migration_older_110>>.

[#migration_older_110]
==== Migration from version less v1.1.0.

With the release of version v1.1.0 we introduced the support of master and dynamic dimensions.
To use this feature, you have to be sure that all expressions
correspond to the expression syntax known from _Qlik Sense_, which means:

* No `'` or `"` before and after field or dimension names
* Expressions should begin with `=`
* Correct spelling (upper-/lowercase) of field or dimension names

After updating, {tcmenu} will guide you through this process.
At first, navigate to the sheets where you use {tcmenu}.
Now, it will automaticly check if you use expressions somewhere.
If so, you will see the dialog below. Please make sure that all expressions comply with the above mentioned specifications.
Once you have done this, you can confirm by clicking on the appropriate button.
Only when all expressions have been confirmed, you are able to save the changes and close the dialog.

.The dialog that leads you trough the migration process
image::version1_1-migration-dialog.png[migration dialog, 320]

[discrete]
===== Automatic migration for published apps in production

Changes to a published app cannot be persisted. So it is necessary to perform the migration in another way:

.Process to migrate published apps
image::migration-procedure.png[migration procedure, 670]

1. Install the new {tcmenu} version in your testing environment.
2. Now open all relevant apps. Check and confirm all expressions. But you will not be able to perform the save operation.
3. Unzip the `tcmenu.zip` and copy the content of all apps from the _Config settings_ dialog in between the curly brackets at _expressionMigration_.
   Make sure that the existing format is maintained.
4. Finally, zip the complete `tcmenu` directory and upload the ZIP file to the _Qlik Management Console_ on the production environment.
   For all expressions in the config file you will not be asked to reconfirm them.

[CAUTION]
====
When you are using {tcmenu} in a publicated app or in mutiple apps with the same expressions, we recommend to update the `config.js`.
The advantage of this variant is that expressions added in the config file do not have to be reconfirmed.

[underline]#For published apps, this is the only way to persist changes on the expressions.#
====

[CAUTION]
An update to the latest version of the {tcmenu} without prior adjustment of the dimension expressions
leads to incorrect evaluation of the dimensions and therefore corrupt published apps!

.The _Config settings_ dialog
image::migration-config-settings.png[migration config settings dialog, 320]
<<<
== Installing {tcmenu}

=== Installation on _Qlik Sense Desktop_

To install {tcmenu} for _Qlik Sense Desktop_, you just have to put the contents of the {tcmenu} ZIP file into the directory `%USERPROFILE%\Documents\Qlik\Sense\Extensions`.

=== Installation on _Qlik Sense Server_

To install {tcmenu} for _Qlik Sense Server_, go into the _Qlik Sense Management Console_ (QMC) and navigate to _Extensions_ via the sidebar. Then click on the _Import_ button which opens the _Import extension file_ dialog where you can browse and import the {tcmenu} ZIP file.

.Importing the extension ZIP file in the QMC.
image::qmc-import.png[qmc-import]

<<<
== Creating a new menu bar

After installing {tcmenu} you can add a new menu bar to your sheet in _Edit mode_ by dragging the entry from the extension sidebar into your sheet. You can add as many menus to your sheet as you need and each can be set up differently.

[[new-menu]]
.A new empty menu bar
image::new-menu.png[new-menu,200]

{tcmenu} features six panes in the properties panel -- _Dimensions_, _Sorting_, _Items_, _Add-ons_, _Appearance_ and _Info_ -- which are covered in the
following sections.

<<<
== Defining dimensions in the _Dimensions_ pane

The _Dimensions_ pane is used to define all the dimensions needed for the _Select_ items of {tcmenu}.

Dimensions can be added in the way known from Qlik Sense. The dimension’s name is subsequently used as the Dimension Title. This value is only for usage in {tcmenu} and can be changed if desired.

.Adding a new dimension to the menu.
image::adding-dimensions.png[adding-dimensions, 250]

The dimensions defined here can be later used in the _Single Select_ or _Sense Select_ items.

.Using the predefined dimensions in a Single Select.
image::dimensions-select.png[adding-dimensions]

=== Sorting

The sorting of dimensions can be edited in the _Sorting_ pane.

The sort order can be set to _Automatic_ or _User Defined_. When the latter is chosen, you can set your desired sorting order which can be one or multiple of:

Load Order:: This is the original order of the records in the data source.
Selection State:: Shows the currently selected values first. For _Sense Selects_ this is the default.
Frequency:: Sorts the values by the frequency of occurrence.
Numeric:: Sorts the values numerically.
Alphabet:: Sorts the values alphabetically.
Expression:: Use a custom expression to control sorting.

.User-defined sorting options for dimensions
image::dimensions-sorting.png[dimensions-sorting,200]

<<<
== Items of {tcmenu}

=== Adding items

{tcmenu} features six different item types:

 * <<Button>>
 * <<button_container>>
 * <<Date Picker>>
 * <<Single Select>>
 * <<Sense Select>>
 * <<Variable Dropdown>>
 * <<Variable Slider>>
 * <<Variable Input>>
 * <<Group>>

To create a new item, open _Items_ in the properties panel and click on _Add Items_. This will create a new _Button Container_ including a new button called _My Button_ by default. The item type can be changed by clicking on the _Type_ drop-down list, which gives you the selection between the different types mentioned above.

.Adding items
image::add-item.png[add-item,200]

.Initial items
image::initial-items.png[initial-items,200]

The first thing you want to do every time you create a new item is giving them distinctive names in the properties panel by using the field _Name (only Property Panel)_. This will help you to identify your items in the properties panel when the configuration of your menu bar grows larger.

==== Reoccurring properties

There are some properties that {tcmenu}'s items have in common. These are:

|====
| Duplicate, Copy/Paste | Actions to duplicate, copy and paste current element. Please read for further explanations
in the following chapter <<Copy/Paste and duplicating Items>>.
| Type | Specifies the item type for current element. Available types are:
_Button_, _Button Container_, _Date Picker_, _Single Select_, _Sense Select_, _Variable Dropdown_, _Variable Slider_, _Variable Input_, _Group_.
| Name (only Property Panel) | This is the name of the item used in the property panel.
| Show condition | This element will only be shown if this condition evaluates to true.
| Use Custom Size | By default,  the item spans over the entire available area. Set this to _Custom_ to define a custom height or width depending on the menu's orientation.
| Text Layout | Can be set to _Single_ for a single line or _Multi_ for a multi-line to show a selection in a _Select_ item.
| Label: Alignment horizontal | Sets the horizontal alignment of the item's label.
| Label: Alignment Vertical | Sets the vertical alignment of the item's label.
| Selection Label | For selectable items sets the preferred label of the selection displayed on the item.
| Icon | Many item labels can have icons you can select from a list.
| Tooltip | The tooltip's text to appear when the user hovers over the item.
|====

=== Copy/Paste and duplicating Items

For easy editing of the {tcmenu} Copy/Paste and Duplicating items offers a fast way to create a {tcmenu}. Once
you have one item defined Copy/Paste and Duplicating allows you to easily create other items with the exact same
definition.

.From left to right: _duplicate_, _copy_, _paste_ button.
image::copypaste.png[copypaste, 200]

You can either duplicate an item to create an exact copy of the item in the current element.
Or you can copy an item and paste it later to replace any item you want.

Furthermore, this function can be used to paste a previously copied element on an element of another {tcmenu} object and
thus to transfer definitions from one {tcmenu} object to another one.

=== Button

_Buttons_ are grouped by states that are defined by conditional expressions. This allows you to use different settings for the button depending on which of the given conditions is true.

.Default properties of a newly created button with one state. Additional states can be created by clicking on Add State.
image::default-button.png[default-button]

NOTE: If more than one condition returns `true` at the same time the first (i.e. uppermost) state will be chosen.

TIP: If you don't need your button to act differently on given conditions just use a single state with the condition `='true'` which is also the default when creating a new button.

==== The Button Editor

The _Button Editor_ is a powerful tool for setting both a button's appearance and its behavior, i.e. the action triggered when the button is pressed. It will be opened when you click on _State Settings_ in one of the button's states.

===== Features

The settings are divided into five categories (General, Layout, Style, Color and Actions) covered in the following sections.

====== General

The _General_ tab features five options:

.Type
The _Type_ list gives you a selection of various predefined button appearances, all of which can be fine-tuned in the adjacent tabs. Apart from that, you can choose between _simple_, _image_, and _custom_ in the _General_ section. The latter two of which can be used to create an image-based or custom-CSS-based button respectively.

.State
The _State_ list is a sub-list of the _Type_ list and covers the _normal_, _active_ and _disabled_ state of the previously chosen type.

.Icon
Using the _Icon_ option you can define an additional icon for the button out of the Font Awesome or Qlik Sense icon repository.

.Text
The _Text_ field is the text used as the label on the button.

.Tooltip
With the _Tooltip_ option, you can define the text shown when the user hovers over the button.

[TIP]
Help other users to understand your button's effect by describing it in the tooltip.

.The Button Editor showing the first tab (General).
image::button-general.png[button-general]

.Image
If you've chosen the _image_ type you can additionally define an _Image url_, the _Position_, and _Size_ of your background image in the _Image_ section.

.The Button Editor as Image type with specific input elements.
image::image-button-editor.png[image-button-editor]

To be able to display images with an image button, these images must first be saved (uploaded) to the trueChart Image Library and selected from there. All images of the trueChart Image Library are stored within the Sense app and are automatically available in duplicated and exported apps.

[CAUTION]
The trueChart Image Library could not changed in published apps since theese are read only in Sense. Existiing images still could be reused.

.The trueChart Image Libary dialog to import, export, insert, rename and delete images.
image::trueChart-media-library.png[trueChart-media-library]

The trueChart Image Library offers the possibility to import images from different sources, so you can take pictures from the Sense media libraries, upload one or more files directly or via a URL.
Other features available in the trueChart Image Library are: Rename, Replace / Update, Delete. The image download is not supported in ie11.

[CAUTION]
Since the contents of the image library are saved globally in an app, they can not be copied to an other app when copying an extension object.
The recommended way to do this is: first export the necessary images in the source app and then import them again into the target mage library. Since the used image has the same names, these images then will be displayed correctly in the copied objects.

.Custom css
If you've chosen the _custom_ type you can define your own CSS rules on the button, giving you the maximal flexibility for the button's appearance.

====== Layout

The _Layout_ tab is for defining the metrics of the button. You can set...

.Dimension
In the _Dimension_ section, you can set the width and height of the button inside its boundaries. This is set to `100%` by default but can be set to any value using CSS units or `auto` to make the button as large as its contents demands.

.Position
In the _Position_ section, you can set the horizontal and vertical alignment of the button inside its boundaries, which is only effective if the respective width or height is set to a value other than `100%`.

.Content alignment
In the _Content alignment_ section, you can define the alignment of the button's text and the icon. The _Text_ alignment is only effective for multiple lines of text on the button.

.Content position
In the _Content position_ section, you can set the horizontal and vertical alignment of the content itself (i.e. the text and the icon together). This is only effective if the respective width or height of the button is not set to `auto`.

.Padding
With the _Padding_ setting, you can disable a predefined padding by choosing _Off_ or override the default padding by choosing _On_ which allows you to set the values in CSS `padding` syntax.

.Margin
With the _Margin_ setting, you can disable a predefined margin by choosing _Off_ or override the default margin by choosing _On_ which allows you to set the values in CSS `margin` syntax.

.An example showing the different layout settings and its effects on the button's appearance.
image::button-layout.png[button-layout]

====== Style

In the _Style_ tab, you can set the visual appearance of the button's content including:

.Font settings
In the _Font_ section, you can set the font properties, i.e. _Family_, _Weight_, _Style_, and _Size_.

.Icon size
Icons have a fixed size, but you can change the scaling in the _Icon_ section using the _Size_ slider to choose between 1x, 1.5x, 2x, 3x, 4x or 5x.

.Background repetition
If you defined a background on your button you can control how the background is repeated with the _Repeat_ setting in the _Background_ section.

.Border
With the _Border_ setting, you can disable a predefined border by choosing _Off_ or override the default border by choosing _On_ which allows you to set the border's color, radius, width, and style. The radius is given in CSS `border-radius` syntax.

.Shadow
The same applies for the button's shadow in the _Shadow_ section. By using _On_ you can define a custom border according to the CSS `box-shadow` syntax: +
`none|_h-shadow v-shadow blur spread color_ |inset|initial|inherit`.

.An example showing the different style settings and its effects on the button's appearance.
image::button-style.png[button-style]

====== Color

The _Color_ tab is used to set the colors for the _normal_ and _hover_ state of the button. This overrides the colors you've set in the _Colors_ section of the _Appearance_ pane and those given by the button type in the _General_ tab of the _Button Editor_. For a detailed list of accepted color expressions, refer to Appendix A.1.

.An example showing the different color settings and its effects on the button's appearance with the button in the hover state.
image::button-color-hover.png[button-style]

====== Actions

In the _Actions_ tab, you can define triggers, that is the actions to take effect when a certain event on the button is triggered.

Possible events to attach actions are:

On click:: Triggered when the user clicks the button.

[CAUTION]
Buttons without triggers and actions, for example, when used as text or image placeholders, do not apply hover effects. In order to achieve this behavior, all triggers must be removed via the delete icon.

Before navigation:: Triggered when the sheet is closed or changed.
On load:: Triggered when the element loads. This can be used to define initial actions like making selections.

[CAUTION]
To avoid critical actions being scattered all over other different items, _On load_ actions like those for initial selections should be defined on a designated element (such as an otherwise non-functional button that serves to show the company's logo).

On selection:: Triggered when the button is selected.
Custom:: Define your own event you can give a custom name. This can be used by involving `HiCo.performCustomTrigger("_triggername_", "_triggerdata_")` in a custom action.

For every event, you can define one or multiple actions, such as _Go to sheet_ to change the view to a different sheet or _Select match_ to alter the current selection.

A full list of provided actions can be found in Appendix B.

.This example establishes an action that sets the City field to New York for the current selection on click of the button.
image::button-action.png[button-action]

====== Execution Order

Actions of a specific trigger are executed in the order they are defined (from top to bottom) without explicitly waiting for each other to be finished before executing the next one. In case of asynchronous calls this may lead to a different execution order.

For most actions (like selecting fields, setting variables, etc.) this is the best option, because they will be performed as fast as possible. This leads to less requests to the "Qlik Sense Engine" and results in better performance/stability.

For use cases were the execution order is important, every action can be defined as "sequential" where the execution order will then be respected, by executing them one by one.

==== Using Expressions

Apart from static values, every input box that features Qlik Sense's _fx_ icon also accepts Sense expressions.

[[button_container,Button Container]]
=== Arranging buttons using _Button Container_

The _Button Container_ is an item to group multiple buttons together while inverting the orientation. That means, if your menu is oriented vertically, the buttons in the container will be arranged horizontally and vice verse.

.A vertically and horizontally arranged menu bar, each featuring two plain buttons and another two buttons in a Button Container in between.
image::ver-hor-menu.png[ver-hor-menu,800]

=== Date Picker

The _Date Picker_ allows selecting single dates, multiple dates and date ranges for sense fields. With the support of dynamic date formats the _Date Picker_
can select almost every possible date.

.Date Picker Element in Property Panel.
image::datepicker-config.png[datepicker-config]

The _Date Picker_ uses the default general settings. The only difference is that the selection label positioning is only available for single and multi _Date Picker_. In the appearance section you can customize the colors used in the _Date Picker_.

<<<

Specific settings for the _Date Picker_ are at the bottom of the properties for the element.

The _Date Picker_ supports three different types:

 * Single only allows one selected date.
 * Multi allows multiple dates to be selected.
 * Range selects a range of dates after picking a start and end date.

Defining a date format is required and the format needs to match the selected dimension. The standard format uses the format from the app settings.
When Setting the format to custom it is possible to define other formats. Valid formats include MM/YYYY, DD/YYYY, D/M/YYYY.

Depending on the format the _Date Picker_ will only show certain Elements. When defining the format DD/MM/YYYY the datepicker will show a Daypicker. The format
MM/YYYY only uses months and years therefore the _Date Picker_ will only show months and years.

The default value is the value that is always selected if nothing else is selected. With the calendar symbol you can open a _Date Picker_ and choose a date
there or you can enter a Sense expression.

Predefines are specific date ranges. There are several default ranges but you can also define custom ranges.

.Predefines Options.
image::datepicker-predefines.png[datepicker-predefines]

Range Date Picker::
The range _Date Picker_ allows selecting a start and end date. The start date is on the left and the end date is on the right. On the far right are
the predefines. On a mobile device the predefines are located in in the header instead. The header also has inputs for the start and end date.

.Range Date Picker.
image::datepicker-range.png[datepicker-range]

Single and Multi Date Picker::
The single _Date Picker_ consists of just one date element and the close and ok button.
It only allows one selection and will remove all other selections beside the clicked date.
Multi _Date Picker_ allows multiple selected dates.

.Single Date Picker.
image::datepicker-single.png[datepicker-single]

Colors::
To show different states of the dates the _Date Picker_ uses several default colors.

 * Dark grey: out of allowed range
 * Green: currently selected in Sense
 * Orange: start or end date
 * Light orange: date between start and end date

All date picker related colors can be configured in general for all date picker elements in the <<Colors>> section.

=== Selects

_Selects_ are drop-down lists that can be prefilled with existing data from previously defined dimensions. {tcmenu} offers two different types of selects, explained in the following sections.

==== Single Select

A _Single Select_ is a drop-down list that allows the user to make selections for *one* dimension defined in the _Dimension_ input box.

.Examples for a Single Select when using dimension without drilldown (left) and with drilldown-dimensions (right)
image::comparison-single-select-with-drilldowns.png[single-select, 450]

The element can have a custom icon defined via the _Icon_ list and label using the _Label_ input box. The latter can be arranged by using the label alignment options for horizontal and vertical alignment (_Label: Alignment Horizontal_ and _Label: Alignment Vertical_).

The _Text Layout_ option can be set to either _Single_ or _Multi_ which switches between a single-line and multi-line arrangement of label and selection label.

The _Single Select_ item also allows to set a _Default Value_ from a fixed string or a evaluated expression. This value is automatically set when opening or changing to the sheet and can be changed afterwards but ensures that the corresponding dimension can never be unset in the selection.

.Properties of Single Select with some example settings.
image::single-select-prop.png[single-select-prop, 200]

Just like the _Label_, the _Selection Label_ is customizable. By default (_Predefined_) it shows the current selection or the number of items selected if they don't fit on the element, but can be also set to a custom values or expression.

If you use the _Single Select_ with drilldown dimensions, you get some more options:

[%header,cols="^.^45, <.^625"]
|===

| Icon
| Functionality

| image:icon-drillup-return.png[icon-drillup-return, 30]
| The _arrow left_ icon clears the selection on the lowest level.

| image:icon-drillup-field-select.png[icon-drillup-field-select, 30]
| When you click on the _field select_ icon, select a certain level. Selections below this level will be removed.

|===

==== Sense Select

_Sense Selects_ use the native selection widget of Qlik Sense and is otherwise configured the same way as a _Single Select_ but you cannot define a default value.

.Examples for a Sense Select when using dimension without drilldown (right) and drilldown-dimensions (left)
image::comparison-sense-select-with-drilldowns.png[sense-select, 450]

For drilldown dimensions, the same settings apply as when used in a _Single Select_ item.

=== Variable Dropdown

The _Variable Dropdown_ element is a drop-down list that allows setting custom values to Qlik Sense variables. Every item in the list represents a value that will be set when the user selects the item. These variables can be used to control other aspects of your apps.

.The definition for a variable value in the properties panel setting the number `10` to the defined variable `results`.
image::variable-dropdown-var.png[variable-dropdown-var,150]

Before using variables you need to create them. This can be done by opening _Variables_ and clicking the _Create new_ button to create a new variable.

.Creating a new variable in the Variables dialog.
image::creating-variable.png[creating-variable,500]

In the properties panel of the _Variable Dropdown_ element, define the variable name in the _Variable Name_ input box and add as many selectable values as desired by clicking on _Add Variable Value_. There you can define the value itself, the label and all the custom alignment settings for each of the added values separately.

.A bar chart that uses a variable as the number of displayed results.
image::bar-chart-variable.png[bar-chart-variable]

=== Variable Slider

The _Variable Slider_ allows to modify the value of variables. Currently the _Variable Slider_ has three different types of variable values.

The three types are single, range and multi slider.

 * Single allows to set one variable in a specific range.
 * Range sets a start and end value to two different variables.
 * Multi slider allows setting multiple variables in a specific range.

.Variable Slider example.
image::variableslider-examples.png[variableslider-examples]

Each slider type has unique settings and some general settings.
General settings include the type, orientation, min and max value, step frequency, visibility of min/max and step values and the date settings. Date
settings allow the slider to not only modify number values but also dates. When using dates it's important to change the date toggle to true and then define
the correct date format. Furthermore all general settings need to be in the specified date format or else it will not work.

*Single slider* requires a variable and its default value.

.Variable Slider Single.
image::variableslider-single.png[variableslider-single]

*Range slider* requires a start and end variable and a default value for both.

.Variable Slider Range.
image::variableslider-range.png[variableslider-range]

*Multi slider* support a list of variables. Each entry consists of the name of the variable to me modified and its default value.
It's important to note that multi sliders will always be in the defined order. E.g. the third variable in the list will always be the third handle on the
 slider.

.Variable Slider Multi.
image::variableslider-multi.png[variableslider-multi]

Colors::
All slider related colors can be configured in general for all date picker elements in the <<Colors>> section.

=== Variable Input

The _Variable Input_ allows to modify the value of variables. _Variable Inputs_  blend in with the menu and are only visible when
the input is clicked.

.Variable Inputs in a menu.
image::variableinput-display.png[variableinput-example]

The _Variable Input_ can be restricted by a type, so that users can only enter certain values.

The restriction types are:

 * No type: no restriction, all inputs are allowed
 * Numeric: only numeric values are allowed
 * Decimal: only decimal values are allowed
 * Date: only dates that follow a specified format are allowed

The property panel for the _Variable Input_ has the standard general settings and a unique section at the bottom.
In the _Variable Input_ section you can define the type, variable name, default value, vertical alignment and horizontal alignment.
When defining a date type it's also required to define a date format.

.Variable Input options.
image::variableinput-options.png[variableinput-options]

=== Group

The _Group Element_ is a dropdown list that allows to combine different  {tcmenu} elements into a single dropdown.

.Group element in property panel.
image::group-example.png[group-example]

<<<
_Group Element_ makes it possible to create dropdowns with multiple button actions (button dropdowns), dropdowns with multiple single and
sense selects (multi selects) or completely new combinations of the different {tcmenu} elements.

.Multiple elements in a single group.
image::group-add-element.png[group-add]

Button dropdowns can be created by adding multiple buttons to the _group element_ and Multi Selects can be created by adding multiple single or sense selects
 to the _group element_

.Multi Select group example.
image::group-multi-example.png[group-multi]

Currently the _Group Element_ supports

 * <<Button>>
 * <<button_container>>
 * <<Date Picker>>
 * <<Single Select>>
 * <<Sense Select>>
 * <<Variable Dropdown>>
 * <<Variable Slider>>
 * <<Variable Input>>

<<<
== The _Add-ons_ pane

In the _Data handling_ section of the _Add-ons_ pane there are two options to control calculation and rendering of either {tcmenu} itself or other charts/extensions that support _calculation conditions_.

.Calculation condition
Use the _Calculation condition_ input box to define a Sense variable that is checked to be `true` before the actual rendering ('`calculation`') takes place. It's also possible to use any function or expression here. The _Displayed message_ is the message to be shown unless the condition is `true` and can be customized.

.Calculation condition variable
The _Calculation condition variable_ is the opposite of the _Calculation condition_: It is do define a variable that is set to `true` as soon as {tcmenu} initialized all the default selections you may have set in _Single Selects_ and to be used by other extensions supporting this _Data handling_ feature.

[CAUTION]
To set the calculation condition variable automatically to `true`, at least one defined default selection is required in a single select. Button actions are currently not supported in connection with this function. A implementation will take place in one of the next versions.

.Dimension calculation
The _Dimension calculation_ switch toggles the calculation for dimensions used in trueChart-Menubar.

The Calculation is *disabled* by default, but in this mode it is not possible to use the same dimension multiple
times.

If you have to use multiple dimensions or if you have a drilldown dimension, which contains
some dimensions, which are already in the dimension list, you have to *enable* the calculation.
In this case you could have some performance drawbacks.

.The calculation condition properties in the _Data handling_ section.
image::calc-cond2.png[calc-cond]

<<<
== The _Appearance_ pane

=== General

The _General_ pane features the following options:

* Show titles
  - Show titles (title, subtitle and footnote) in the menu box.
* Title
  - Enter a title for the menu bar. The title is also displayed above the menu when _Show titles_ is set to _On_.
* Subtitle and Footnote
  - Enter and display an additional subtitle and footnote (only if _Show titles_ is set to _On_).
* Show details
  - This option has currently no effects.

=== Layout

.Orientation
Define the orientation of the menu which can be either horizontal or vertical. This has no effect on small mobile devices where the orientation is adjusted automatically to vertical.

.Width Setting
When the menu is oriented vertically the items can be set to be stretched to the maximum width (_Fill_) or you can define a custom width (_Custom_).

.Height Setting
When the menu is oriented horizontally the menu bar can take all the available height (_Fill_) or you can define a custom height (_Custom_).

In vertical orientation this setting is used to use the background color over entire height (_Fill_) or only to the last menu item (_Automatic_).

.The _Layout_ section in the _Appearance_ pane
image::appearance-layout.png[appearance-layout,200]

=== Position

In the _Position_ section, you can set the position of the menu bar inside its boundaries when the width or height is set to values in pixel other than _Automatic_. For example, the value 0 for Top removes the distance to the edge or next object above the menu completely.

.The _Position_ section showing default and individual settings.
image::appearance-position.png[appearance-position,200]

=== Colors

The _Colors_ section is to define the default colors of the menu to be inherited by its items.
These can be configured by entering color expressions, setting predefined colors or choosing with the color picker.

In this area, numerous color definitions can be made for the following elements:

* Main elements (generic), with area and text colors for background, hover and active states, borders and separators
* Subelements (generic), with area and text colors for background, hover and active states, borders and separators
* Selections (generic - currently only for <<Date Picker>> and <<Variable Slider>>), with colors for normal, alternative and
excluded selections areas and texts
* <<Date Picker>> elements, with colors for buttons, selections, active or not allowed fields, texts, normal
and hover states
* Slider elements (<<Variable Slider>>), with colors for background, slider track and handle, normal and active steps

For a detailed list of accepted color expressions, refer to Appendix A.1.

.Part of the _Colors_ section in the _Appearance_ pane showing preselected colors and the color picker.
image::appearance-colors.png[appearance-colors,200]

=== Text

The _Text_ section features all settings to take effect on the font, such as:

* Font family
* Font weight
* Font style
* Font size

These are set separately for general _Labels_ and also _Selection Labels_, i.e. selected values showing on {tcmenu}'s elements.

.The _Text_ section in the _Appearance_ pane.
image::appearance-text.png[appearance-text,200]

=== Display

In the _Display_ section, you can set the visibility of the Sense menu, selection, title bar, snapshot button and maximize button. The elements can be
permanently hidden (_Hide_), shown (_Show_ = default setting) or displayed depending on an expression.
Snapshot button and maximize button options are only applied to the current menu extension.

[TIP]
If the Sense menu is not visible and the Edit mode is not available for this reason, it can be simply activated by Ctrl + E.

[CAUTION]
When using several menu objects on a sheet, ensure that all menus are defined identically for these settings. Otherwise, one menu could hide a bar and another could show this bar again, depending on which menu object is loaded as last one by Sense.

.Define visibility of Sense menu, selection and title bar
image::display_prop.png[display_prop,200]

=== Info

The _Info_ section shows general information, such as version number of {tcmenu}.

It also provides a link to open this documentation.

// [glossary]
// == Glossary
// Brauchen::
//   Wir ein Glossar
// Oder::
//   Werden alle Begriffe im Text deutlich?

<<<
[appendix]
== List of useful CSS definitions for button styling
The _Button Editor_ makes heavy use of CSS definitions for styling buttons. The following lists give an overview on frequently used CSS properties.

=== Colors

The following color expressions can be used in {tcmenu}:

* Color names: `black`, `white`, `red`, etc.
* Hex values, three or six digits: `#f80`, `#ff8800`
* Hex values, four or eight digits (alpha channel): `#f087`, `#ff008877`
* RGB and RGBA: `rgb(255,127,0)`, `rgba(255,127,0,.5)` or `rgb(255 127 0)`, `rgba(255 127 0 / .5)`
* HSL and HSLA: `hsl(360,100%,50%)`, `hsla(360,100%,50%,.8)` or `hsl(360 100% 50%)`, `hsla(360 100% 50% / .8)`
* ARGB: `=argb(127,255,63,15)` with the alpha channel being a value between `0` and `255`.

[appendix]
== List of actions for triggers

The following actions can be attached to events that trigger a button.

=== None

[%header,cols="30%,70%"]
|===
| Action | Parameters
| None | _No parameters._
|===

=== Custom

[%header,cols="30%,70%"]
|===
| Action | Parameters
| Custom | A custom JS function to be executed with the _Custom_ event.
|===

=== Navigation

[%header,cols="30%,70%"]
|===
| Action | Parameters
| Next sheet/page | _No parameters._
| Previous sheet/page | _No parameters._
| Go to sheet | _Sheet id_ of the sheet to go to; can be entered manually or automatically by using the drop-down list.
| Go to story | _Story id_ of the story to go to; can be entered manually or automatically by using the drop-down list.
| Go to url | Specify the URL in the _Url_ input box and the target in the _Target_ list. The _Mashup only_ option restricts the action to mashups.
| Go to app a| Specify the id of the app you'd like to navigate to in the _App ID_ input box
and the id of the specific sheet in the _Sheet ID_ input.

image:buttoneditor-actions-gotoapp.png[buttoneditor-actions-gotoapp, 738]

If you select _Email_ as the target you can further specify an _email address_, _email subject_
and _email body_. You can use _{0}_ as a placeholder for the generated link.
If omitted, it will be inserted at the end of the body.
You can also specify the link to be opened in the _same, new, custom named window_
or just be copied to the clipboard.

It is possible to _clear all selections_ or apply _current selections_
in the target app by checking the corresponding checkboxes.
For _current selections_ to work, the currently selected fields/dimensions need to be present in the target app as well.

Additionally you can add optional parameters to apply specific selections
or a bookmark.

.Limitations:
* In "Qlik Sense Desktop" the _Email_ target doesn't work.
* Fields/Dimensions containing "%" characters, they will not be applied.
* When importing apps from another system, their ID changes. So, for example,
 if you designed a target app locally and push it to a server, this action will
 no longer work since the target app ID has changed. It needs to be manually
 repaired. This is also the case when publishing.
| Share app a| Specify the _target_ of a generated link to be shared as email or added to clipboard.

If you select _Email_ as the target you can further specify an _email address_, _email subject_ and _email body_.
You can use _{0}_ as a placeholder for the generated link. If omitted, it will be inserted at the end of the body.
Target clipboard adds the generated link to the clipboard and shows a message to the user.

.Limitations:
 * In "Qlik Sense Desktop" the _Email_ target doesn't work.
 * In mashup/story mode the URL can't be properly generated.
|===

=== Sense

[%header,cols="30%,70%"]
|===
| Action | Parameters
| Set variable | Specify the variable and value to be set in the _Sense variable_ and _Variable content_ input box. The _Keep_ option keeps the value unchanged if it's already set.
| Select value(s) | Select the field and value(s) in the _Field name_ and _Value(s)_ input box. The _Toggle_ option will toggle between selected states. The _Soft lock_ option sets locked selections to be overridden. The _Keep_ option sets existing selections for the selected field to remain unchanged. The _Add_ option sets the values to be added to the existing selection.
| Select match | Specify the field to be selected and value(s) in the _Field name_ and _Value(s)_ input box. The _Soft lock_ option sets locked selections to be overridden. The _Keep_ option sets existing selections for the selected field to remain unchanged.
| Select alternative | Specify the field to be selected in the _Field name_ input box. The _Soft lock_ option sets locked selections to be overridden.
| Select excluded | Specify the field to be selected in the _Field name_ input box. The _Soft lock_ option sets locked selections to be overridden.
| Select possible | Specify the field to be selected in the _Field name_ input box. The _Soft lock_ option sets locked selections to be overridden.
| Select all | Specify the field to be selected in the _Field name_ input box. The _Soft lock_ option sets locked selections to be overridden.
| Clear field | Select the field to be cleared in the _Field name_ input box.
| Clear other | Select the field in the _Field name_ input box. The _Soft lock_ option sets locked selections to be overridden.
| Clear all | Set the _Locked also_ option to also clear locked selections.
| Lock field | Select the field in the _Field name_ input box.
| Lock all | Set the _Locked also_ option to also clear locked selections.
| Unlock field |Select the field in the _Field name_ input box.
| Unlock all | _No parameters._
| Apply bookmark | _Bookmark id_ which can be entered manually or automatically by using the drop-down list.
| Reload data | Set the desired mode in the _Mode_ list. Set the _Partial_ option to do only a partial reload.

|===

[CAUTION]
The _Reload data_ action should be used with extreme care as reloading the app triggers a sheet reload which can result in the complete loss of unsaved comments on this sheet.
Additionally, in the case of publicated apps, it is neccessary to create a corresponding _Security Rule_ on the _Qlik Sense_ server.

=== Other

[%header,cols="30%,70%"]
|===
| Action | Parameters
| Toggle fullscreen | Expression which must result 0 (disable fullscreen), 1 (go to fullscreen) or can be empty (toggles current fullscreen mode). This action is only on click trigger avaliable, due to browser security restrictions.
|===

<<<
[appendix]
== Releases Notes

:sectnums!:
[#release_notes_latest_version]
=== {tcmenu} v{appversion}

{docdate}

* Features and Improvements
** New element item: Date Range Picker (single, multi, range) [HICO-2562]
** New element item: Variable slider (single, multi, range) [HICO-2460]
** New element item: Inputbox [HICO-2561]
** Options to disable sense snapshot and maximize object buttons [HICO-2931]
** New button action "Unlock field" [HICO-40891]
** Selection based color configuration for single select elements [HICO-40931]

* Bugs
** Button Action "Select Value(s)" not working for all field types (numeric vs. text) [HICO-40918]

=== {tcmenu} v1.2.6

2018-05-22

* Bugs
** Pop up windows at bottom opens down, so they not usable [HICO-40732]
** Filters in app chaining break the URL if the dimension values contain backslashes [HICO-40852]
** Incorrect behavior in connection with the sense engine with opened sense selections that are hidden by a dynamic display condition [HICO-41017]
** Menubar dropdowns are overlapped by trueChart comment cells [HICO-41033]

=== {tcmenu} v1.2.5

2018-05-08

* Bugs
** Menubar selections not showing in any cases [HICO-40903]
** SelectValues action in button do not select, when field already has selections [HICO-40944]
** Trigger action "clear Field" is not executed [HICO-40950]
** onSelection trigger of a button skips the first onSelection event [HICO-40967]

=== {tcmenu} v1.2.4

2018-04-09

* Bugs
** Select items remain "unselected" even if corresponding fields have selections [HICO-40884]
** Button does not perform any further actions if a previous action was defined incorrectly and cannot be executed [HICO-40885]
** Full screen action do not toggle after the toggle condition was edited [HICO-40888]
** Failed upgrade (to 1.1.0) leads to repetitive update tries [HICO-40890]

=== {tcmenu} v1.2.3

2018-04-03

* Bugs
** Pop up windows at bottom opens down, so they not usable [HICO-40732]
** Filters in app chaining break the URL if the dimension values contain backslashes [HICO-40852]
** Incorrect behavior in connection with the sense engine with opened sense selections that are hidden by a dynamic display condition [HICO-41017]
** Menubar dropdowns are overlapped by trueChart comment cells [HICO-41033]

=== {tcmenu} v1.2.5

2018-05-08

* Bugs
** Menubar selections not showing in any cases [HICO-40903]
** SelectValues action in button do not select, when field already has selections [HICO-40944]
** Trigger action "clear Field" is not executed and Sense-Select is "empty" when opened [HICO-40950]
** onSelection trigger of a button skips the first onSelection event [HICO-40967]

=== {tcmenu} v1.2.4

2018-04-09

* Bugs
** Select items remain "unselected" even if corresponding fields have selections [HICO-40884]
** Button does not perform any further actions if a previous action was defined incorrectly and cannot be executed [HICO-40885]
** Full screen action do not toggle after the toggle condition was edited [HICO-40888]
** Failed upgrade (to 1.1.0) leads to repetitive update tries [HICO-40890]

=== {tcmenu} v1.2.3

2018-04-03

* Bugs
** Changes in button-editor are not applied [HICO-40881]

=== {tcmenu} v1.2.2

2018-02-27

* Features and Improvements
** Disable calculations in tcmenus HyperCube [HICO-40853]

[CAUTION]
Properties updates can not be applied when the app is published! To upgrade {tcmenu} properly,
you have to open the published app in a writable stream (i.e. by duplicating it),
open a sheet containing the {tcmenu}, so that updates can be performed.
Afterwards you can (re-)publish the updated app.

=== {tcmenu} v1.2.1

2018-02-09

* Bugs
** Select sorting after migration to v1.2 not correct (custom expression is missing) [HICO-40731]

=== {tcmenu} v1.2.0

2018-2-5

* Features and Improvements
** *New action "Go to app" (document chaining)* [HICO-2564]
** *New action "Share app" (email | clipboard)* [HICO-40703]
** *Responsive font sizes* (menubar and buttons) [HICO-2901]
** *Grouping of elements*: Single & Sense Select, Variable Dropdown, Button & Button Container [HICO-40496]
*** Migration of multi and button dropdown elements to group elements [HICO-40533]
** *Option to duplicate and copy/paste existing elements and sub elements* [HICO-2233]
** Trigger default selection when showing single select again [HICO-40576]

* Bugs
** Exception when creating new dimensions in extension as master item [HICO-40671]

=== {tcmenu} v1.1.3

2018-1-31

** Bugs
* Exception when creating new dimensions in extension as master item [HICO-40671]
* Inline icon in button text is not displayed [HICO-40712]

=== {tcmenu} v1.1.2

2018-1-22

** Bugs
* Sense export was broken with version 1.1.1 [HICO-40659]

=== {tcmenu} v1.1.1

2018-1-18

** Bugs
* General text settings do not affect correctly [HICO-40627]
* JS-Exception while migration from v.1.0.4 to v1.1.0 [HICO-40646]

=== {tcmenu} v1.1.0

2018-1-4

** Features and Improvements
* *Support of Sense PDF export function* [HICO-2178]
* *Support of drill-down dimensions* in selections (Single, Sense and Multi) [HICO-2560]
* *Conditional display and hiding of menu elements* [HICO-2890]
* Improvement when using master item dimensions and expression-based dimensions [HICO-2524]
* Specify expressions for dimension definition directly [HICO-2601]
* Option to enter title, subtitle or footnote [HICO-2889]
* Mark button+ actions for parallel (faster) or sequential (in order)execution [HICO-40445]
* New position of edit button state in properties panel [HICO-40461]
* Performance: Reduced initial loading time [HICO-40463]

** Bugs
* Menubar destroys representation of Sense filter pane objects in same sheet [HICO-2726]
* Button+ UI code editor not working [HICO-2905]
* [JS-Exception] due to incorrect default value expressions in single select items [HICO-2939]
* Custom actions are not visible initially after reopening button+ editor [HICO-40454]
* [JS-Exception] TypeError: Cannot read property 'layout' of undefined [HICO-40487]

=== {tcmenu} v1.0.8

2017-11-22

** Features and Improvements
* *Support of Sense 2017.11 Release* (works also with v1.0.7)
* Button+: Automatic line breaks in button+ text [HICO-2324]

** Bugs
* Button+ overwrites default hover color of the tCMenu, although no hover color is defined in Button+ [HICO-2897]
* Button+ code editor not working in tc menubar [HICO-2905]
* Scrolling with the mouse wheel in Sense Select does not work with IE11 [HICO-2933]
* Single select description text im menubar not initial visible on iPad [HICO-28625]
* Sense select breakes after selection with dynamic dimensions [HICO-31517]

=== {tcmenu} v1.0.7

2017-09-28

** Features and Improvements
* *Support of Sense 2017.09 Release* [HICO-2572]
* Button+: Custom CSS can defined as expression [HICO-2718]
* HiCo.API: Code-Notification after {tcmenu} painting [HICO-2834]

=== {tcmenu} v1.0.6

2017-08-15

** Features and Improvements
* *Option to hide sense navigation, title and selection bar* [HICO-2559]
* Button+: Definition of padding & margin [HICO-2301]
* Button+: Image library (apps include used images for export) [HICO-2506]
* Button+: Add new toggle fullscreen action [HICO-2687]

=== {tcmenu} v1.0.5

2017-07-27

** Features and Improvements
* *Support of Sense 2017.07 Release* [HICO-2571]

** Bug
* Initial logo does not match the object size [HICO-2419]
* Change of background color not applied [HICO-2598]
* JS Exception on click on button dropdown [HICO-2675]

=== {tcmenu} v1.0.4

2017-06-28

** Features and Improvements
* Improvement in handling session timeouts (selections fail, display not correct) [HICO-2612]
* Add option to apply default selections sequentially [HICO-2620]

** Bug
* Sense Select and Single Select broken with Error from Engine after toggeling qlikSense Mode [HICO-2453]
* Sense Dropdown is sometimes empty [HICO-2584]
* Accumulation of the QlikSense error "Internal error" with trueChart4Sense-3.2.4 [HICO-2618]


=== {tcmenu} v1.0.3

2017-06-15

** Features and Improvements
* Copy dimension name as default value to label [HICO-2369]
* Show action cursor and hover color only if button actions defined [HICO-2450]
* Renaming tc-Menu > {tcmenu} [HICO-2473]
* Hidden field support for select actions in button+ [HICO-2531]

** Bug
* Initial selection is not reset correctly when using dynamic (expression) default selection value for Single Selects [HICO-2413]
* Wrong selection count / undefined in selection label [HICO-2416]
* Dropdown placeholder in menu to long [HICO-2417]
* ButtonPlus IE overlay in DropDown General State [HICO-2434]
* Select value(s) action not working correct with some number values [HICO-2440]
* Button not updated after setting new state condition [HICO-2441]
* Menu elements in IE differs from Chrome [HICO-2443]
* Dropdown backround longer than element size [HICO-2444]
* Hover color isn't working in Button Dropdown IE [HICO-2456]
* Extension repaint while open/close sense select [HICO-2470]
* Performance issues in "edit" mode, in combination with Qlik Sense v3.2SR3 or v3.2SR4 [HICO-2498]
* Error while perform selection based on master item with expression [HICO-2514]
* Expression based dimensions not working correct, selected dimension on item could be removed [HICO-2523]
* New menu property calculation variable is not visible [HICO-2537]
* Vertical Multi-Select scrolls to top when opening Single Select [HICO-2553]

=== {tcmenu} v1.0.2

2017-05-05

** Features and Improvements
*  Performance Improvement: Improve variable updates [HICO-2386]
*  Indication of running selections as calculation variable and
minor improvements on button action editor (sorting & add new action) [HICO-2391]
*  User documentation in "Apperance/Info" section in properties panel [HICO-2392]

** Bug
* Default selections lead to endles loop when fields hidden by data script [HICO-2393]

=== {tcmenu} v1.0.1

2017-04-25

** Features and Improvements
* Position adjustment settings for trueChart & {tcmenu} to remove spaces in sense grid object layout [HICO-1949]
* Horizontal menu is displayed in the small device (less iPad) as a vertical menu [HICO-2224]
* Font-Family and Text-Style Settings [HICO-2225]
* MashUp Support for Button+ and {tcmenu} (incl. HiCo MashUp Template Update) [HICO-2226]
* Custom Scrolling for TCMenu [HICO-2227]
* Touch support for trueChart & {tcmenu} [HICO-2243]
* Performance improvement regarding button+ and trueChart communication with sense [HICO-2255]

** Bug
* Selection label is empty after opening sheet [HICO-2216]
* Variable dropdown selection lable switch has no effect, if custom label was defined [HICO-2230]
* Qlik color expression (argb) is evaluated wrong [HICO-2234]
* Horizontal seperator is repeated on the right [HICO-2235]
* Single Select scroll position for selected element is not as expected (for long lists) [HICO-2236]
* No seperator between element and subelement in vertical menu [HICO-2238]
* No scrolling in long horizontal Button Dropdown elements [HICO-2239]
* Button Dropdown selection label is not working [HICO-2241]
* Multi Select name can't be an expression -> no expression support for elements name anymore [HICO-2245]
* Menu element icons can't be removed [HICO-2247]
* Scrollbar doesn't disapear after reseting scrolling condition [HICO-2257]
* Buttons not clickable in IE11 and wrong styles displayed (trueChart and {tcmenu}) [HICO-2271]
* Sorting at sense selection incorrect -> [HICO-2319]
    * If sorting is set to automatic, the sorting by selection status (ascending) is set internally
    * If sorting is defined manually, the user has to define the sorting himself and, if necessary,
      he must also specify the sorting by selection status. With this sort, the selection behavior
      corresponds to the Qlik Sense standard.
    * The recommendation is to define sorting by selection status for Sense Selects and
      never for single selection (corresponds to the automatic behavior).
* Performance improvement: Single Selects default selections are triggered multiple times [HICO-2357]

=== {tcmenu} v1.0.0

2017-03-23

** Epic
* {tcmenu} Extension [HICO-1983]
* *Trigger Action Button* (Button+), supports multiple trigger actions (OnLoad, OnSelection, OnClick, BeforNavigation) and advanced button styling [HICO-1984]
* *User based customizable button+ actions* per extension ({tcmenu} & trueChart) [HICO-2193]